{"ast":null,"code":"var _jsxFileName = \"/Users/maheshsamale/frontend_technical_assessment/frontend/src/nodes/textNode.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport { Position, useReactFlow } from 'reactflow';\nimport { BaseNode } from './BaseNode';\nimport { useStore } from '../store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VAR_REGEX = /\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/g;\nexport const TextNode = ({\n  id,\n  data\n}) => {\n  _s();\n  const [currText, setCurrText] = useState((data === null || data === void 0 ? void 0 : data.text) || '');\n  const [variables, setVariables] = useState([]);\n  const textAreaRef = useRef(null);\n  const overlayRef = useRef(null);\n  const containerRef = useRef(null);\n  const updateNodeField = useStore(s => s.updateNodeField);\n  const clearNode = useStore(s => s.clearNode); // â¬…ï¸ you must have this in store\n  const {\n    setEdges\n  } = useReactFlow(); // â¬…ï¸ remove edges\n\n  // -----------------------------------\n  // Sync text â†’ variables â†’ store\n  // -----------------------------------\n  useEffect(() => {\n    const matches = [...currText.matchAll(VAR_REGEX)].map(m => m[1]);\n    const unique = [...new Set(matches)];\n    setVariables(unique);\n    updateNodeField(id, 'text', currText);\n    updateNodeField(id, 'variables', unique);\n  }, [currText, id, updateNodeField]);\n\n  // -----------------------------------\n  // Auto resize textarea\n  // -----------------------------------\n  useEffect(() => {\n    const ta = textAreaRef.current;\n    const ov = overlayRef.current;\n    const container = containerRef.current;\n    if (!ta || !ov || !container) return;\n    ta.style.height = 'auto';\n    ta.style.height = ta.scrollHeight + 'px';\n    container.style.height = ta.style.height;\n    ov.scrollTop = ta.scrollTop;\n  }, [currText]);\n\n  // -----------------------------------\n  // ðŸ”¥ Cleanup when node is deleted\n  // -----------------------------------\n  useEffect(() => {\n    return () => {\n      console.log('TextNode cleanup:', id);\n\n      // âœ… Remove node data from store\n      if (clearNode) {\n        clearNode(id);\n      }\n\n      // âœ… Remove all edges connected to this node\n      setEdges(edges => edges.filter(e => e.source !== id && e.target !== id));\n    };\n  }, [id, clearNode, setEdges]);\n\n  // -----------------------------------\n  // Highlight rendering\n  // -----------------------------------\n  const renderOverlay = () => {\n    const parts = currText.split(/(\\{\\{\\s*[a-zA-Z_$][a-zA-Z0-9_$]*\\s*\\}\\})/g);\n    return parts.map((part, i) => {\n      const match = part.match(/\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/);\n      if (match) {\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            background: '#e0e7ff',\n            color: '#3730a3',\n            borderRadius: '4px',\n            padding: '0 4px',\n            fontWeight: 600\n          },\n          children: part\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this);\n      }\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        children: part\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 14\n      }, this);\n    });\n  };\n  const textStyle = {\n    fontFamily: 'monospace',\n    fontSize: '14px',\n    lineHeight: '22px',\n    letterSpacing: '0px',\n    padding: '10px',\n    whiteSpace: 'pre-wrap',\n    wordWrap: 'break-word',\n    boxSizing: 'border-box'\n  };\n  return /*#__PURE__*/_jsxDEV(BaseNode, {\n    id: id,\n    label: \"Text\",\n    handles: variables.map((v, i) => ({\n      type: 'target',\n      position: Position.Left,\n      id: v,\n      style: {\n        top: `${(i + 1) * (100 / (variables.length + 1))}%`\n      }\n    })),\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        position: 'relative',\n        minWidth: '220px',\n        border: '1px solid #e5e7eb',\n        borderRadius: '8px',\n        background: '#fff'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ref: overlayRef,\n        style: {\n          ...textStyle,\n          position: 'absolute',\n          inset: 0,\n          color: '#111827',\n          pointerEvents: 'none',\n          overflow: 'hidden'\n        },\n        children: [renderOverlay(), currText === '' && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#9ca3af'\n          },\n          children: \"Type ...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        ref: textAreaRef,\n        value: currText,\n        onChange: e => setCurrText(e.target.value),\n        spellCheck: false,\n        onScroll: () => {\n          if (overlayRef.current && textAreaRef.current) {\n            overlayRef.current.scrollTop = textAreaRef.current.scrollTop;\n          }\n        },\n        style: {\n          ...textStyle,\n          position: 'relative',\n          width: '100%',\n          resize: 'none',\n          border: 'none',\n          outline: 'none',\n          background: 'transparent',\n          color: 'transparent',\n          caretColor: '#111827',\n          overflow: 'hidden'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n};\n_s(TextNode, \"+lgwdbkpMA1f4NE71UyF3NyWZfk=\", false, function () {\n  return [useStore, useStore, useReactFlow];\n});\n_c = TextNode;\nvar _c;\n$RefreshReg$(_c, \"TextNode\");","map":{"version":3,"names":["useState","useEffect","useRef","Position","useReactFlow","BaseNode","useStore","jsxDEV","_jsxDEV","VAR_REGEX","TextNode","id","data","_s","currText","setCurrText","text","variables","setVariables","textAreaRef","overlayRef","containerRef","updateNodeField","s","clearNode","setEdges","matches","matchAll","map","m","unique","Set","ta","current","ov","container","style","height","scrollHeight","scrollTop","console","log","edges","filter","e","source","target","renderOverlay","parts","split","part","i","match","background","color","borderRadius","padding","fontWeight","children","fileName","_jsxFileName","lineNumber","columnNumber","textStyle","fontFamily","fontSize","lineHeight","letterSpacing","whiteSpace","wordWrap","boxSizing","label","handles","v","type","position","Left","top","length","ref","minWidth","border","inset","pointerEvents","overflow","value","onChange","spellCheck","onScroll","width","resize","outline","caretColor","_c","$RefreshReg$"],"sources":["/Users/maheshsamale/frontend_technical_assessment/frontend/src/nodes/textNode.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport { Position, useReactFlow } from 'reactflow';\nimport { BaseNode } from './BaseNode';\nimport { useStore } from '../store';\n\nconst VAR_REGEX = /\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/g;\n\nexport const TextNode = ({ id, data }) => {\n  const [currText, setCurrText] = useState(data?.text || '');\n  const [variables, setVariables] = useState([]);\n\n  const textAreaRef = useRef(null);\n  const overlayRef = useRef(null);\n  const containerRef = useRef(null);\n\n  const updateNodeField = useStore((s) => s.updateNodeField);\n  const clearNode = useStore((s) => s.clearNode);   // â¬…ï¸ you must have this in store\n  const { setEdges } = useReactFlow();               // â¬…ï¸ remove edges\n\n  // -----------------------------------\n  // Sync text â†’ variables â†’ store\n  // -----------------------------------\n  useEffect(() => {\n    const matches = [...currText.matchAll(VAR_REGEX)].map(m => m[1]);\n    const unique = [...new Set(matches)];\n\n    setVariables(unique);\n    updateNodeField(id, 'text', currText);\n    updateNodeField(id, 'variables', unique);\n\n  }, [currText, id, updateNodeField]);\n\n  // -----------------------------------\n  // Auto resize textarea\n  // -----------------------------------\n  useEffect(() => {\n    const ta = textAreaRef.current;\n    const ov = overlayRef.current;\n    const container = containerRef.current;\n    if (!ta || !ov || !container) return;\n\n    ta.style.height = 'auto';\n    ta.style.height = ta.scrollHeight + 'px';\n    container.style.height = ta.style.height;\n    ov.scrollTop = ta.scrollTop;\n  }, [currText]);\n\n  // -----------------------------------\n  // ðŸ”¥ Cleanup when node is deleted\n  // -----------------------------------\n  useEffect(() => {\n    return () => {\n      console.log('TextNode cleanup:', id);\n\n      // âœ… Remove node data from store\n      if (clearNode) {\n        clearNode(id);\n      }\n\n      // âœ… Remove all edges connected to this node\n      setEdges((edges) =>\n        edges.filter(\n          (e) => e.source !== id && e.target !== id\n        )\n      );\n    };\n  }, [id, clearNode, setEdges]);\n\n  // -----------------------------------\n  // Highlight rendering\n  // -----------------------------------\n  const renderOverlay = () => {\n    const parts = currText.split(\n      /(\\{\\{\\s*[a-zA-Z_$][a-zA-Z0-9_$]*\\s*\\}\\})/g\n    );\n\n    return parts.map((part, i) => {\n      const match = part.match(/\\{\\{\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\\s*\\}\\}/);\n      if (match) {\n        return (\n          <span\n            key={i}\n            style={{\n              background: '#e0e7ff',\n              color: '#3730a3',\n              borderRadius: '4px',\n              padding: '0 4px',\n              fontWeight: 600,\n            }}\n          >\n            {part}\n          </span>\n        );\n      }\n      return <span key={i}>{part}</span>;\n    });\n  };\n\n  const textStyle = {\n    fontFamily: 'monospace',\n    fontSize: '14px',\n    lineHeight: '22px',\n    letterSpacing: '0px',\n    padding: '10px',\n    whiteSpace: 'pre-wrap',\n    wordWrap: 'break-word',\n    boxSizing: 'border-box',\n  };\n\n  return (\n    <BaseNode\n      id={id}\n      label=\"Text\"\n      handles={variables.map((v, i) => ({\n        type: 'target',\n        position: Position.Left,\n        id: v,\n        style: {\n          top: `${(i + 1) * (100 / (variables.length + 1))}%`,\n        },\n      }))}\n    >\n      <div\n        ref={containerRef}\n        style={{\n          position: 'relative',\n          minWidth: '220px',\n          border: '1px solid #e5e7eb',\n          borderRadius: '8px',\n          background: '#fff',\n        }}\n      >\n        {/* Highlight layer */}\n        <div\n          ref={overlayRef}\n          style={{\n            ...textStyle,\n            position: 'absolute',\n            inset: 0,\n            color: '#111827',\n            pointerEvents: 'none',\n            overflow: 'hidden',\n          }}\n        >\n          {renderOverlay()}\n          {currText === '' && (\n            <span style={{ color: '#9ca3af' }}>\n              Type ...\n            </span>\n          )}\n        </div>\n\n        {/* Real textarea */}\n        <textarea\n          ref={textAreaRef}\n          value={currText}\n          onChange={(e) => setCurrText(e.target.value)}\n          spellCheck={false}\n          onScroll={() => {\n            if (overlayRef.current && textAreaRef.current) {\n              overlayRef.current.scrollTop =\n                textAreaRef.current.scrollTop;\n            }\n          }}\n          style={{\n            ...textStyle,\n            position: 'relative',\n            width: '100%',\n            resize: 'none',\n            border: 'none',\n            outline: 'none',\n            background: 'transparent',\n            color: 'transparent',\n            caretColor: '#111827',\n            overflow: 'hidden',\n          }}\n        />\n      </div>\n    </BaseNode>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}